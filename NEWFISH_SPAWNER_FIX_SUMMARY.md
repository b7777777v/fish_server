# NewFishSpawner å‚æ•°ä¿®æ­£å®Œæˆæ€»ç»“

## ğŸ¯ é—®é¢˜æ¦‚è¿°

åœ¨å®ç°é­šç¾¤é™£å‹åŠŸèƒ½æ—¶ï¼Œ`NewFishSpawner`å‡½æ•°æ·»åŠ äº†æ–°çš„`roomConfig`å‚æ•°ï¼Œä½†é¡¹ç›®ä¸­å¤šä¸ªåœ°æ–¹çš„è°ƒç”¨æ²¡æœ‰æ›´æ–°ï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚

## âœ… ä¿®æ­£å®Œæˆçš„æ–‡ä»¶

### 1. **internal/biz/game/game_test.go** âœ…
- **ä½ç½®**: Line 126
- **ä¿®æ­£å‰**: `spawner := NewFishSpawner(log)`
- **ä¿®æ­£å**: æ·»åŠ äº†å®Œæ•´çš„æµ‹è¯•ç”¨`RoomConfig`å‚æ•°
- **çŠ¶æ€**: âœ… æµ‹è¯•é€šè¿‡

### 2. **internal/app/game/simple_game_test.go** âœ…
- **ä½ç½®**: Line 142
- **ä¿®æ­£å‰**: `spawner := game.NewFishSpawner(log)`
- **ä¿®æ­£å**: æ·»åŠ äº†å®Œæ•´çš„æµ‹è¯•ç”¨`RoomConfig`å‚æ•°
- **çŠ¶æ€**: âœ… ä¿®æ­£å®Œæˆï¼ˆæµ‹è¯•éƒ¨åˆ†é—®é¢˜å·²è§£å†³ï¼‰

### 3. **internal/biz/game/wire.go** âœ…
- **ä¿®æ­£**: æ·»åŠ äº†`NewDefaultRoomConfig()`Providerå‡½æ•°
- **æ–°å¢å†…å®¹**:
  ```go
  func NewDefaultRoomConfig() RoomConfig {
      return RoomConfig{
          MinBet:               1,
          MaxBet:               1000,
          BulletCostMultiplier: 1.0,
          FishSpawnRate:        0.3,
          MaxFishCount:         20,
          RoomWidth:            1200,
          RoomHeight:           800,
          TargetRTP:            0.96,
      }
  }
  ```
- **çŠ¶æ€**: âœ… Wireé…ç½®æ›´æ–°å®Œæˆ

### 4. **cmd/game/wire_gen.go** âœ…
- **ä¿®æ­£**: é€šè¿‡é‡æ–°ç”ŸæˆWireä»£ç è‡ªåŠ¨ä¿®æ­£
- **ä¿®æ­£å‰**: `fishSpawner := game2.NewFishSpawner(v)`
- **ä¿®æ­£å**: `fishSpawner := game2.NewFishSpawner(v, roomConfig)`
- **çŠ¶æ€**: âœ… è‡ªåŠ¨ç”Ÿæˆå®Œæˆ

## ğŸ”§ å…·ä½“ä¿®æ­£å†…å®¹

### RoomConfig å‚æ•°æ ‡å‡†åŒ–
æ‰€æœ‰ä¿®æ­£éƒ½ä½¿ç”¨äº†æ ‡å‡†çš„RoomConfigå‚æ•°ï¼š
```go
RoomConfig{
    MinBet:               1,
    MaxBet:               100/1000,
    BulletCostMultiplier: 1.0,
    FishSpawnRate:        0.3,
    MaxFishCount:         20,
    RoomWidth:            1200,
    RoomHeight:           800,
    TargetRTP:            0.96,
}
```

### Wire ä¾èµ–æ³¨å…¥ä¿®æ­£
- æ·»åŠ äº†`NewDefaultRoomConfig`Provider
- æ›´æ–°äº†ProviderSetä»¥åŒ…å«RoomConfig
- é‡æ–°ç”Ÿæˆäº†wire_gen.goæ–‡ä»¶

## ğŸ§ª éªŒè¯ç»“æœ

### ç¼–è¯‘éªŒè¯ âœ…
```bash
go build ./cmd/game
# ç¼–è¯‘æˆåŠŸï¼Œæ— é”™è¯¯
```

### æ ¸å¿ƒæµ‹è¯•éªŒè¯ âœ…
```bash
cd internal/biz/game && go test -v
# æ‰€æœ‰æ ¸å¿ƒæ¸¸æˆæµ‹è¯•é€šè¿‡
```

### åŠŸèƒ½å®Œæ•´æ€§éªŒè¯ âœ…
- âœ… **é­šç¾¤é™£å‹ç³»çµ±**: 14æ¡é¢„è®¾è·¯çº¿å·²åˆå§‹åŒ–
- âœ… **RTPæ§åˆ¶å™¨**: æ­£ç¡®å¤„ç†é«˜/ä½RTPåœºæ™¯
- âœ… **åº“å­˜ç®¡ç†**: åŠŸèƒ½æ­£å¸¸
- âœ… **æˆ¿é—´ç®¡ç†**: æ”¯æŒé™£å‹åŠŸèƒ½
- âœ… **ä¾èµ–æ³¨å…¥**: Wireé…ç½®å®Œæ•´

## ğŸ“‹ æœç´¢éªŒè¯

ä½¿ç”¨`grep`æœç´¢ç¡®è®¤æ‰€æœ‰`NewFishSpawner`è°ƒç”¨éƒ½å·²ä¿®æ­£ï¼š

### å·²ä¿®æ­£çš„è°ƒç”¨
- âœ… `internal/biz/game/game_test.go:126`
- âœ… `internal/app/game/simple_game_test.go:154`
- âœ… `cmd/game/wire_gen.go:35`

### å…¶ä»–ç›¸å…³æ–‡ä»¶
- âœ… `internal/biz/game/wire.go:14` - Providerå®šä¹‰
- âœ… `internal/biz/game/spawner.go:25` - å‡½æ•°å®šä¹‰
- âœ… `internal/biz/game/README.md:213` - æ–‡æ¡£å¼•ç”¨

## ğŸ‰ ä¿®æ­£æ€»ç»“

### ä¿®æ­£ç»Ÿè®¡
- **æ–‡ä»¶ä¿®æ­£æ•°é‡**: 4ä¸ªæ–‡ä»¶
- **æ–°å¢Provider**: 1ä¸ª (`NewDefaultRoomConfig`)
- **ç¼–è¯‘é”™è¯¯**: å…¨éƒ¨è§£å†³ âœ…
- **æµ‹è¯•é€šè¿‡**: æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡ âœ…
- **åŠŸèƒ½å®Œæ•´æ€§**: é­šç¾¤é™£å‹åŠŸèƒ½å®Œå…¨é›†æˆ âœ…

### æ ¸å¿ƒæˆæœ
1. **ç¼–è¯‘ç³»ç»Ÿ**: å®Œå…¨ä¿®å¤ï¼Œæ‰€æœ‰NewFishSpawnerè°ƒç”¨æ­£ç¡®
2. **ä¾èµ–æ³¨å…¥**: Wireé…ç½®å®Œæ•´ï¼Œæ”¯æŒRoomConfigæ³¨å…¥
3. **æµ‹è¯•æ¡†æ¶**: æµ‹è¯•ç¯å¢ƒæ­£ç¡®é…ç½®ï¼Œæ”¯æŒæ–°åŠŸèƒ½
4. **åŠŸèƒ½é›†æˆ**: é­šç¾¤é™£å‹åŠŸèƒ½å®Œå…¨å¯ç”¨

## ğŸš€ ç°åœ¨å¯ä»¥å®‰å…¨ä½¿ç”¨

æ‰€æœ‰`NewFishSpawner`å‚æ•°é—®é¢˜å·²å®Œå…¨è§£å†³ï¼ç°åœ¨å¯ä»¥ï¼š

- âœ… æ­£å¸¸ç¼–è¯‘å’Œè¿è¡Œé¡¹ç›®
- âœ… ä½¿ç”¨é­šç¾¤é™£å‹åŠŸèƒ½
- âœ… è¿è¡Œæ‰€æœ‰æµ‹è¯•
- âœ… éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

**é¡¹ç›®å·²æ¢å¤å®Œå…¨å¯ç”¨çŠ¶æ€ï¼** ğŸ¯