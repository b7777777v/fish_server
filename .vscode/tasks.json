{
    "version": "2.0.0",
    "tasks": [
        // ========================================
        // ‰ª£Á¢ºÁîüÊàê‰ªªÂãô
        // ========================================
        {
            "label": "wire-gen",
            "type": "shell",
            "command": "go",
            "args": ["generate", "./..."],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "silent",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": "$go"
        },
        {
            "label": "proto-gen",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/proto-gen.sh",
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go"
        },
        
        // ========================================
        // ÊßãÂª∫‰ªªÂãô - Â§öÁí∞Â¢É
        // ========================================
        {
            "label": "üî® Build Admin - DEV",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-tags", "dev",
                "-ldflags", "-X main.environment=dev -X main.buildTime=${env:BUILD_TIME}",
                "-o", "cmd/admin/admin-dev${pathSeparator}exe",
                "./cmd/admin"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go",
            "dependsOn": "wire-gen"
        },
        {
            "label": "üî® Build Admin - STAGING",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-tags", "staging",
                "-ldflags", "-X main.environment=staging -X main.buildTime=${env:BUILD_TIME} -s -w",
                "-o", "cmd/admin/admin-staging${pathSeparator}exe",
                "./cmd/admin"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go",
            "dependsOn": "wire-gen"
        },
        {
            "label": "üî® Build Admin - PROD",
            "type": "shell",
            "command": "go",
            "args": [
                "build",
                "-tags", "prod",
                "-ldflags", "-X main.environment=production -X main.buildTime=${env:BUILD_TIME} -s -w",
                "-o", "cmd/admin/admin-prod${pathSeparator}exe",
                "./cmd/admin"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go",
            "dependsOn": "wire-gen"
        },
        
        // ========================================
        // Docker ÊßãÂª∫‰ªªÂãô
        // ========================================
        {
            "label": "üê≥ Docker Build - DEV",
            "type": "shell",
            "command": "docker",
            "args": [
                "build",
                "-f", "deployments/Dockerfile.admin",
                "-t", "fish-server-admin:latest",
                "--build-arg", "ENVIRONMENT=dev",
                "."
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "üê≥ Docker Build - STAGING",
            "type": "shell",
            "command": "docker",
            "args": [
                "build",
                "-f", "deployments/Dockerfile.admin",
                "-t", "fish-server-admin:staging",
                "--build-arg", "ENVIRONMENT=staging",
                "."
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        
        // ========================================
        // Áí∞Â¢ÉÁÆ°ÁêÜ‰ªªÂãô
        // ========================================
        {
            "label": "üöÄ Start DEV Environment",
            "type": "shell",
            "command": "docker-compose",
            "args": [
                "-f", "deployments/docker-compose.dev.yml",
                "--env-file", "deployments/.env.dev",
                "up", "-d"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "üèóÔ∏è Start STAGING Environment",
            "type": "shell",
            "command": "docker-compose",
            "args": [
                "-f", "deployments/docker-compose.staging.yml",
                "--env-file", "deployments/.env.staging",
                "up", "-d"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "üõë Stop All Environments",
            "type": "shell",
            "command": "sh",
            "args": [
                "-c",
                "docker-compose -f deployments/docker-compose.dev.yml down && docker-compose -f deployments/docker-compose.staging.yml down"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        
        // ========================================
        // Ê∏¨Ë©¶‰ªªÂãô
        // ========================================
        {
            "label": "üß™ Test All",
            "type": "shell",
            "command": "go",
            "args": ["test", "./..."],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go"
        },
        {
            "label": "üß™ Test Admin Service",
            "type": "shell",
            "command": "go",
            "args": ["test", "./internal/app/admin/..."],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go"
        },
        {
            "label": "üß™ Test with Coverage",
            "type": "shell",
            "command": "go",
            "args": [
                "test",
                "./...",
                "-coverprofile=coverage.out",
                "-covermode=atomic"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": "$go"
        },
        
        // ========================================
        // È©óË≠â‰ªªÂãô
        // ========================================
        {
            "label": "‚úÖ Verify DEV Pprof",
            "type": "shell",
            "command": "curl",
            "args": [
                "-f",
                "http://localhost:6060/debug/pprof/"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "‚ùå Verify STAGING Pprof Disabled",
            "type": "shell",
            "command": "curl",
            "args": [
                "http://localhost:6061/debug/pprof/disabled"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "üìä Check Environment Info",
            "type": "shell",
            "command": "sh",
            "args": [
                "-c",
                "echo '=== DEV Environment ===' && curl -s http://localhost:6060/admin/env | jq && echo '\\n=== STAGING Environment ===' && curl -s http://localhost:6061/admin/env | jq"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        
        // ========================================
        // Ê∏ÖÁêÜ‰ªªÂãô
        // ========================================
        {
            "label": "üßπ Clean Build Artifacts",
            "type": "shell",
            "command": "sh",
            "args": [
                "-c",
                "rm -f cmd/admin/admin-* cmd/game/game-* coverage.out"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        },
        {
            "label": "üßπ Clean Docker Images",
            "type": "shell",
            "command": "docker",
            "args": [
                "rmi",
                "fish-server-admin:latest",
                "fish-server-admin:staging"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": []
        }
    ]
}